import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

public class CustomerOrder 
{
	private String orderId;
	private String userName;
	private Map<Pizza, Integer> pizzaInventory;
	private double totalPrice = 0;
	
	public CustomerOrder(String orderId, String userName)
	{
		this.orderId = orderId;
		this.userName = userName;
		pizzaInventory = new HashMap<>();
	}
	
	public void addPizzaToOrder(Pizza pizza)
	{
		totalPrice += pizza.getPrice();
		pizzaInventory.put(pizza, pizzaInventory.getOrDefault(pizza, 0) + 1);
	}
	
	public void removePizzaFromOrder(Pizza pizza)
	{
		if (!pizzaInventory.containsKey(pizza))
		{
			return;
		}
		
		totalPrice -= pizza.getPrice();
		int count = pizzaInventory.get(pizza);
		
		if (count == 1)
		{
			pizzaInventory.remove(pizza);
		}
		else
		{
			pizzaInventory.put(pizza, count -1);
		}
	}

	public String getOrderId() 
	{
		return orderId;
	}

	public String getUserName() 
	{
		return userName;
	}

	public List<Pizza> getPizzas() 
	{
		List<Pizza> pizzaList = new LinkedList<>();
		
		for (Pizza pizza : pizzaInventory.keySet())
		{
			for (int i = 0; i < pizzaInventory.get(pizza); i++)
			{
				pizzaList.add(pizza);
			}
		}
		
		return pizzaList;
	}
	
	public double getTotalPrice() 
	{
		return totalPrice;
	}
	
	@Override
	public String toString()
	{
		StringBuilder builder = new StringBuilder();
		
		for (Pizza pizza : pizzaInventory.keySet())
		{
			builder.append(pizza.toString()).append("-").append(pizzaInventory.get(pizza)).append(", ");
		}
		
		return String.format("Order Id: %s, User Name: %s, Pizza: %s", orderId, userName, builder.toString());
	}
}
